<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>VulnSpiral — Help</title>
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  />
  <style>
    body{padding:24px}
    code{background:#f6f8fa;padding:2px 4px;border-radius:4px}
    pre{background:#f6f8fa;padding:12px;border-radius:6px}
  </style>
</head>
<body>
  <div class="container">
    <h1>VulnSpiral — User Guide</h1>
    <p class="text-muted">Protocol & Application fuzzer for DUTs (e.g., Wi-Fi CPEs). Use only with authorization.</p>

    <h3>1. Quick Start</h3>
    <ol>
      <li>Open the UI at <code>/ui</code>. Ensure your Kali NIC (e.g., <code>wlan0</code>) reaches the DUT.</li>
      <li>Right panel: <strong>Scan &amp; Seeds</strong> → enter the DUT IP (e.g., <code>192.168.8.1</code>), choose presets, click <strong>Start scan</strong>.</li>
      <li>When ports appear, click <strong>Use TCP/UDP &lt;port&gt;</strong> to populate the fuzz form and set transport automatically.</li>
      <li>Left panel: choose <strong>Interface</strong>, <strong>Engine</strong> (e.g., <em>radamsa</em>), <strong>Seeds</strong>, then <strong>Start fuzz</strong>.</li>
      <li>Live logs: left = fuzz log, right = scan log. PCAPs listed under <strong>PCAPs</strong> with download/delete.</li>
    </ol>

    <h3>2. Engines</h3>
    <ul>
      <li><strong>radamsa</strong>: Mutational fuzzing using seed inputs; fastest to trigger parsing bugs.</li>
      <li><strong>boofuzz</strong>: Session/field-aware fuzzing (install via pip, templates can be added later).</li>
      <li><strong>custom</strong>: Scapy-based simple mutator for packets/messages.</li>
      <li><strong>proxy</strong>: Local proxy that mutates traffic in transit (binds a local port).</li>
    </ul>

    <h3>3. Seeds</h3>
    <p>Create seeds from the UI (HTTP/DNS/SSH/Custom). For Custom, paste hex or auto-generate. Seeds are stored in
      <code>examples/seed_samples/</code>. The fuzz engine mutates these aggressively.</p>

    <h3>4. Scanning</h3>
    <p>Choose scanner: <strong>nmap (no ping)</strong> or <strong>builtin</strong>. Presets: Top 1000 / Recommended / All / Custom. Use
      <strong>Stop scan</strong> to cancel long runs. Scan progress is visible in the <em>Port Scan Log</em>.</p>

    <h3>5. Captures & Evidence</h3>
    <ul>
      <li>Each fuzz run creates <code>runs/&lt;run_id&gt;/pcaps/&lt;run_id&gt;.pcap</code>.</li>
      <li>Use the PCAPs table to Download/Delete runs.</li>
      <li>Evidence helper: <code>python tools/collect_evidence.py &lt;run_id&gt;</code> builds a JSON/HTML summary.</li>
    </ul>

    <h3>6. Tips for CPEs</h3>
    <ul>
      <li>Common ports: TCP 22, 80, 443, 7547; UDP 53, 1900/SSDP, 161/SNMP, 5353/mDNS.</li>
      <li>Start with valid-ish seeds (HTTP GET, DNS query, SSH banner) and increase mutation rate gradually.</li>
      <li>Monitor DUT console & kernel logs externally while fuzzing.</li>
    </ul>

    <h3>7. Legal & Safety</h3>
    <p>Only test systems you own or have explicit permission to test. Misuse can be illegal and disruptive.</p>

    <h3>8. Troubleshooting</h3>
    <ul>
      <li>PCAP empty: ensure you selected the correct interface and have permissions for packet capture/sniffing.</li>
      <li>UDP cases: some services respond rarely; still valuable to provoke parser behavior.</li>
      <li>Frontend not loading: rebuild with <code>npm run build</code>.</li>
    </ul>

    <hr/>
    <p class="text-muted">VulnSpiral © MIT License.</p>
  </div>
</body>
</html>
